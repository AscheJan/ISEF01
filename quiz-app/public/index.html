<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz-App - Anmeldung</title>
    <link rel="icon" type="image/x-icon" href="assets/img/favicon.ico">
    <link rel="stylesheet" href="assets/css/style.css">
    <script src="/socket.io/socket.io.js"></script>
    <script defer src="assets/js/main.js" defer></script>
</head>
<body>
    <div id="gameContainer">
        <div id="home">
            <div class="container">
                <img src="assets/img/logo.png" alt="Quiz-App Logo">
                <h1>Willkommen zum Quiz</h1>
                <p>Bitte melde dich an oder registriere dich, um am Quiz teilzunehmen.</p>
            </div>
            
            
            <input type="text" id="username" placeholder="Benutzername">
            <input type="password" id="password" placeholder="Passwort">
            <button onclick="login()">Anmelden</button>
            <button onclick="showRegister()">Registrieren</button>
            <p id="error" style="color: red;"></p>
        </div>

        <div id="register" style="display:none;">
            <h1>Registrierung</h1>
            <input type="text" id="newUsername" placeholder="Benutzername">
            <input type="email" id="newEmail" placeholder="E-Mail (nur @iu-study.org)" pattern=".*@iu-study\.org$" required>
            <input type="password" id="newPassword" placeholder="Passwort">
            <button onclick="register()">Registrieren</button>
            <button onclick="showLogin()">ZurÃ¼ck zur Anmeldung</button>
            <p id="registerError" style="color: red;"></p> <!-- Fehleranzeige hier -->
        </div>
        

        <!-- âœ… Dashboard-Bereich -->
        <div id="dashboard" style="display:none;">
            <h1>Dashboard</h1>
            <p>Willkommen, <span id="displayUsername"></span>!</p>
            <button onclick="createGame()">Spiel starten</button>
            <button onclick="openJoinGameModal()">Spiel beitreten</button>
            <button onclick="openUserQuizManager()">ğŸ§  Eigene Quiz verwalten</button>
            <!-- ğŸ† Button zum Ã–ffnen der Legende -->
            <button onclick="openGameRulesModal()">ğŸ“– Spielregeln anzeigen</button>
            <button onclick="logout()">Abmelden</button>
            <!-- ğŸ“œ Spielregeln Modal -->
            <div id="gameRulesModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <span class="close" onclick="closeGameRulesModal()">&times;</span>
                    <h2>ğŸ“œ Spielmodi & Regeln</h2>
                    <p>Hier findest du die Regeln fÃ¼r alle Spielmodi.</p>
                    
                    <h3>ğŸ”µ Klassisch</h3>
                    <p>Beantworte alle Fragen der Reihe nach. Kein Zeitlimit.</p>

                    <h3>â³ Zeitangriff</h3>
                    <p>Du hast nur 5 Sekunden pro Frage. Nach Ablauf der Zeit wird automatisch weitergeschaltet.</p>

                    <h3>ğŸ² Shuffle</h3>
                    <p>Die Fragen erscheinen in zufÃ¤lliger Reihenfolge.</p>

                    <h3>ğŸ’€ Ãœberleben</h3>
                    <p>Eine falsche Antwort und das Spiel ist vorbei! Versuche, so viele Fragen wie mÃ¶glich richtig zu beantworten.</p>

                    <h3>âš¡ Blitzmodus</h3>
                    <p>Du hast insgesamt 60 Sekunden fÃ¼r das gesamte Quiz. Je schneller du antwortest, desto mehr Fragen kannst du schaffen.</p>

                    <h3>ğŸ’° Risiko</h3>
                    <p>Setze deine Punkte auf jede Frage: Richtig = doppelte Punkte, falsch = Punkteverlust.</p>

                    <h3>ğŸ­ 50:50 Joker</h3>
                    <p>Einmal pro Spiel kannst du zwei falsche Antworten eliminieren.</p>

                    <h3>â™¾ï¸ Endlos</h3>
                    <p>Das Quiz endet nie! Fragen werden nach dem Durchlauf neu gemischt.</p>
                </div>
            </div>
        </div>
        <div id="userQuizManager" style="display: none; margin-top: 2rem;">
          <h2>ğŸ§  Eigene Quiz-Verwaltung</h2>
        
          <!-- Deck-Erstellung -->
          <input type="text" id="userDeckName" placeholder="Deckname eingeben" />
          <button onclick="createUserDeck()">Deck erstellen</button>
          <button onclick="showDeleteDeckConfirmation()">ğŸ—‘ Deck lÃ¶schen</button>

        
          <select id="userDeckSelect" onchange="loadUserDeckQuestions()">
            <option value="">-- WÃ¤hle ein Deck --</option>
          </select>
        
          <!-- Fragen -->
          <h3>ğŸ“‹ Fragen im ausgewÃ¤hlten Deck</h3>
          <ul id="userQuestionList"></ul>
          <button onclick="openAddUserQuestionModal()">â• Neue Frage</button>
        
          <!-- Modal fÃ¼r Fragen -->
          <div id="userQuestionModal" style="display:none;">
            <h4 id="questionModalTitle">Frage erstellen</h4>
            <input id="userQuestionText" placeholder="Fragetext" />
            <input id="userOption1" placeholder="Option 1" />
            <input id="userOption2" placeholder="Option 2" />
            <input id="userOption3" placeholder="Option 3" />
            <input id="userOption4" placeholder="Option 4" />
            <input id="userCorrectOption" placeholder="Korrekte Option (1â€“4)" type="number" min="1" max="4" />
            <button onclick="saveUserQuestion()">ğŸ’¾ Speichern</button>
            <button onclick="closeUserQuestionModal()">âŒ Abbrechen</button>
            <input type="hidden" id="userEditingQuestionId" />
          </div>
        </div>

        <!-- ğŸ”’ BestÃ¤tigungs-Modal -->
        <div id="confirmDeleteModal" class="custom-modal" style="display: none;">
          <div class="modal-content">
            <p>MÃ¶chtest du diese Frage wirklich lÃ¶schen?</p>
            <button onclick="deleteUserQuestionConfirmed()">ğŸ—‘ Ja, lÃ¶schen</button>
            <button onclick="closeDeleteConfirmation()">âŒ Abbrechen</button>
          </div>
        </div>

        <div id="confirmDeleteDeckModal" class="custom-modal" style="display: none;">
          <div class="modal-content">
            <p>MÃ¶chtest du dieses Deck wirklich lÃ¶schen? Alle Fragen darin werden ebenfalls entfernt.</p>
            <button onclick="deleteUserDeckConfirmed()">âœ… Ja, lÃ¶schen</button>
            <button onclick="closeDeleteDeckConfirmation()">âŒ Abbrechen</button>
          </div>
        </div>
        

        

        <!-- âœ… Modal fÃ¼r Spiel beitreten -->
        <div id="joinGameModal" class="modal" style="display: none;">
            <div class="modal-content">
                <span class="close" onclick="closeJoinGameModal()">&times;</span>
                <h2>ğŸ”‘ Spiel beitreten</h2>
                <p>Gib den Raumcode ein, um einem Spiel beizutreten:</p>
                <input type="text" id="roomCodeInput" placeholder="Raumcode eingeben">
                <button onclick="joinGame()">Beitreten</button>
                <button onclick="closeJoinGameModal()">âŒ Abbrechen</button> <!-- SchlieÃŸen-Button -->
            </div>
        </div>

        <div id="lobby">
            <h2>ğŸ•¹ Wartelobby</h2>
          
            <p id="roomCode">â³ Raumcode wird erstellt...</p>
            <p id="status"></p>
          
            <!-- Status der eigenen Auswahl -->
            <p id="statusDeck">ğŸ“– Deck: Noch nicht gewÃ¤hlt</p>
            <p id="statusGameMode">ğŸ® Modus: Noch nicht gewÃ¤hlt</p>
          
            <h3>ğŸ¯ Moduswahl der Spieler</h3>
            <ul id="multiplayerGameModeList"></ul>
          
            <div id="playerList"></div>
          
            <button id="leaveButton" style="display: none;">ğŸ”™ Lobby verlassen</button>
          
            <h3>ğŸ“š Deck auswÃ¤hlen</h3>
            <select id="selectDeck">
              <option value="">-- Decks werden geladen... --</option>
            </select>
          
        
            <h3>Spielmodus wÃ¤hlen:</h3>
            <div id="gameModeSelection" class="mode-grid">
                <button onclick="selectGameMode('classic')" data-mode="classic">ğŸ”µ Klassisch</button>
                <button onclick="selectGameMode('timeattack')" data-mode="timeattack">â³ Zeitangriff</button>
                <button onclick="selectGameMode('shuffle')" data-mode="shuffle">ğŸ² Shuffle</button>
                <button onclick="selectGameMode('survival')" data-mode="survival">ğŸ’€ Ãœberleben</button>
                <button onclick="selectGameMode('speed')" data-mode="speed">âš¡ Blitz</button>
                <button onclick="selectGameMode('risk')" data-mode="risk">ğŸ’° Risiko</button>
                <button onclick="selectGameMode('endless')" data-mode="endless">â™¾ï¸ Endlos</button>
              </div>
              

            <button id="readyButton" style="display:none;">Bereit</button>
            <p id="status">Bitte wÃ¤hle ein Deck und einen Spielmodus.</p>



            
        </div>
        
        <!-- âœ… QUIZ-ANSICHT -->
        <div id="quizContainer" style="display: none;">
            <h2>ğŸ§  Quiz lÃ¤uft...</h2>
            <p id="scoreDisplay">ğŸ† Punktestand: 0</p>
        
            <!-- âœ… Hier wird die Frage angezeigt -->
            <div id="question-container">
                <h3 id="questionText">Frage wird geladen...</h3>
                <div id="answerOptions"></div>
            </div>

        </div>
        
        <!-- âœ… QUIZ BEENDET -->
        <div id="finalScreen" style="display: none;">
            <h2>ğŸ‰ Quiz beendet!</h2>
            <p id="finalScore"></p>
            <div id="leaderboard"></div> <!-- Leaderboard wird hier geladen -->
            <button onclick="location.reload()">ğŸ”„ Neues Spiel</button>
        </div>
        
        
                
        <!-- ğŸš¨ Modal zum Melden einer Frage -->
        <div id="reportModal" style="display:none;">
            <h2>Frage melden</h2>
            <p>Gib bitte den Grund fÃ¼r die Meldung an:</p>
            <textarea id="reportReason" placeholder="Grund fÃ¼r die Meldung..."></textarea>
            <input type="hidden" id="reportQuestionId">
            <input type="hidden" id="reportQuizDeckId">
            <button onclick="submitReport()">Meldung absenden</button>
            <button onclick="closeReportModal()">Abbrechen</button>
        </div>


        <div id="adminPanel" style="display:none;">
            <h1>Administratorbereich</h1>
            <button onclick="openAdminModal()">Decks verwalten & Fragen erstellen</button>
            <button onclick="openReportedQuestionsModal()">Gemeldete Fragen</button>
        </div>
        
        <!-- ğŸš¨ Modal fÃ¼r gemeldete Fragen -->
        <div id="reportedQuestionsModal" style="display:none;">
            <h2>Gemeldete Fragen</h2>
            <ul id="reportedQuestionsList"></ul>
            <button onclick="closeReportedQuestionsModal()">SchlieÃŸen</button>
        </div>

        <!-- ğŸš€ Modal zur Bearbeitung gemeldeter Fragen -->
        <div id="editReportedQuestionSection" style="display:none; ">
            <h2>Frage bearbeiten</h2>
            <input type="hidden" id="editReportedReportId">
            <input type="hidden" id="editReportedQuestionId">

            <label for="editReportedQuestionText">Frage:</label>
            <input type="text" id="editReportedQuestionText">

            <label for="editReportedOption1">Antwort 1:</label>
            <input type="text" id="editReportedOption1">

            <label for="editReportedOption2">Antwort 2:</label>
            <input type="text" id="editReportedOption2">

            <label for="editReportedOption3">Antwort 3:</label>
            <input type="text" id="editReportedOption3">

            <label for="editReportedOption4">Antwort 4:</label>
            <input type="text" id="editReportedOption4">

            <label for="editReportedCorrectOption">Richtige Antwort (0-3):</label>
            <input type="number" id="editReportedCorrectOption" min="0" max="3">

            <button onclick="validateReportedQuestion()">âœ… Validieren</button>
            <button onclick="closeEditReportedQuestion()">âŒ Abbrechen</button>
        </div>

        
        
        <!-- Modal fÃ¼r Deck-Verwaltung und Fragen-Erstellung -->
        <div id="adminModal" style="display: none;" role="dialog" aria-modal="true" aria-labelledby="adminModalTitle">
            <div class="modal-content">
          
              <!-- ğŸ”¤ Titel -->
              <header>
                <h2 id="adminModalTitle">Decks verwalten &amp; Fragen hinzufÃ¼gen</h2>
                <div class="button-group">
                  <button class="close-btn" onclick="closeAdminModal()" aria-label="Modal schlieÃŸen">SchlieÃŸen</button>
                </div>
              </header>
          
              <!-- ğŸ“¦ Neues Deck erstellen -->
              <section>
                <h3>Neues Deck erstellen</h3>
                <form class="input-group" onsubmit="event.preventDefault(); createDeck();">
                  <input type="text" id="deckName" placeholder="Deck-Name eingeben" required>
                  <button type="submit" class="primary-btn">Deck erstellen</button>
                </form>
              </section>
          
              <!-- ğŸ“š Bestehende Decks -->
              <section>
                <h3>Bestehende Decks</h3>
                <ul id="deckList" class="list-style">
                  <li>
                    <span>Wochenende</span>
                    <button class="icon-btn" title="Deck lÃ¶schen">ğŸ—‘</button>
                  </li>
                </ul>
              </section>
          
              <!-- ğŸ”„ Fragen zu Deck hinzufÃ¼gen -->
              <section>
                <h3>Fragen zu Deck hinzufÃ¼gen</h3>
                <label for="selectDeckAdmin">Deck auswÃ¤hlen</label>
                <select id="selectDeckAdmin" onchange="loadAdminQuestions()" required>
                  <option value="">-- Deck auswÃ¤hlen --</option>
                  <option value="6826119202c9c41bc4bf46d3">Wochenende</option>
                </select>
              </section>
          
              <!-- â• Neue Frage -->
              <section>
                <h3>Neue Frage hinzufÃ¼gen</h3>
                <form onsubmit="event.preventDefault(); addQuestion();">
                  <input type="text" id="questionText" placeholder="Fragetext eingeben" required>
                  <div class="grid-2">
                    <input type="text" id="option1" placeholder="Antwort 1" required>
                    <input type="text" id="option2" placeholder="Antwort 2" required>
                    <input type="text" id="option3" placeholder="Antwort 3" required>
                    <input type="text" id="option4" placeholder="Antwort 4" required>
                  </div>
                  <input type="number" id="correctOption" min="1" max="4" placeholder="Richtige Antwortnummer (1â€“4)" required>
                  <button type="submit" class="primary-btn">Frage hinzufÃ¼gen</button>
                </form>
              </section>
          
              <!-- ğŸ“‹ Fragen verwalten -->
              <section>
                <h3>Fragen verwalten</h3>
                <ul id="adminQuestionList" class="list-style"></ul>
              </section>
              
            </div>
          </div>
          
          

        <!-- Modal fÃ¼r Frage bearbeiten -->
        <div id="editQuestionModal" style="display:none;">
            <h2>Frage bearbeiten</h2>
            <input type="hidden" id="editQuestionId">
            <input type="text" id="editQuestionText" placeholder="Fragetext">
            <input type="text" id="editOption1" placeholder="Antwort 1">
            <input type="text" id="editOption2" placeholder="Antwort 2">
            <input type="text" id="editOption3" placeholder="Antwort 3">
            <input type="text" id="editOption4" placeholder="Antwort 4">
            <input type="number" id="editCorrectOption" min="1" max="4" placeholder="Richtige Antwortnummer (1â€“4)" >
            <button onclick="editQuestion()">ğŸ’¾ Speichern</button>
            <button onclick="closeEditQuestionModal()">âŒ Abbrechen</button>
          </div>
    </div>

    <!-- Delete Deck Modal -->
    <div id="deleteDeckModal" class="modal" style="display: none;">
        <div class="modal-content">
        <h3>Deck lÃ¶schen</h3>
        <p id="deleteDeckText">MÃ¶chtest du dieses Deck wirklich lÃ¶schen?</p>
        <div class="button-group">
            <button class="btn cancel-btn" onclick="closeDeleteDeckModal()">Abbrechen</button>
            <button class="btn danger-btn" onclick="confirmDeleteDeck()">LÃ¶schen</button>
        </div>
        </div>
    </div>
  
    <!-- Delete Question Modal -->
    <div id="deleteModal" class="modal" style="display: none;">
        <div class="modal-content">
        <h3>Frage lÃ¶schen</h3>
        <!-- Hier wird der Frage-Text hineingeschrieben -->
        <p id="deleteModalText">â“ Soll diese Frage wirklich gelÃ¶scht werden?</p>
        <div class="button-group">
            <button class="btn cancel-btn" onclick="closeDeleteModal()">Abbrechen</button>
            <!-- Dieser Button bekommt spÃ¤ter per JS den Listener -->
            <button id="confirmDeleteBtn" class="btn danger-btn">LÃ¶schen</button>
        </div>
        </div>
    </div>
  
      
    
</body>
<footer class="footer">
    <div class="footer-container">
        <p>&copy; 2025 Alle Rechte vorbehalten. IU ISEF01</p>
    </div>
</footer>

</html>